/*!build time : 2013-10-16 11:07:07 AM*/
KISSY.add("gallery/lap/0.1/index",function(a){function b(){var b=a.makeArray(arguments);a.each(b.shift(),function(a){a.apply(null,b)})}function c(b,c){var e=this,f=a.merge(d,c);e.handleData=[].concat(b),e.cfg=f,e.doIndex=-1,e.fnHandlers=[],e.fnBatches=[],e.fnCallbacks=[],e.duration=f.duration||300,e.delay=f.delay||30,e.isPause=!1,e.isStop=!1}var d={duration:300,delay:100},e=[];return a.augment(c,a.EventTarget,{handle:function(a){this.fnHandlers.push(a)},batch:function(a){this.fnBatches.push(a)},then:function(a){this.fnCallbacks.push(a)},start:function(){var a=this;if(a.isStop)throw new Error("the task has complete.");a.isPause=!1,setTimeout(function(){a._process()},0)},process:function(){a.later(this._process,0)},pause:function(){this.isPause=!0},stop:function(){this.isStop||this._stop()},_stop:function(){this.isStop=!0,b(this.fnCallbacks)},_process:function(){var a=this,c=a.handleData,d=a.fnHandlers;if(!(a.isStop||a.isPause&&c.length>0)){var e=+new Date+a.duration,f=-1;do{var g=c.shift();void 0!==g&&(a.doIndex++,f++,b(d,g,a.doIndex,f))}while(c.length>0&&e>+new Date&&!a.isPause&&!a.isStop);b(a.fnBatches,a.doIndex),0!=c.length||a.isStop?setTimeout(function(){a._process()},a.delay):a._stop()}}}),function(a,b){var d=new c(a,b);return e.push(d),d}});